# instructions.md

このファイルは、AI コーディングアシスタント（GitHub Copilot、Claude Code 等）がこのリポジトリで作業する際の共通ガイドラインです。

## プロジェクト概要

このリポジトリは、mabl（E2E テストツール）のための静的 HTML テストサイトです。さまざまな UI パターンを個別のページとして用意しており、ブラウザ操作や要素検出、ダウンロード、フォーム入力などのシナリオをテストできます。

サーバーサイドのアプリケーションロジックはなく、すべてのページは静的ファイルとして Nginx から配信されます。

## プロジェクト構成

- `index.html` - トップページ（日本語）。各テストページへのリンクをまとめたランディングページ
- `001/` - 画像表示・ダウンロード
- `002/` - テーブル表示 (5x5)
- `003/` - OTP 入力フィールド（6 桁、オートフォーカス／ペースト対応）
- `004/` - ファイルアップロード（localStorage 永続化）
- `005/` - Basic 認証 UI
- `006/` - 複数テキスト入力
- `007/` - テキストエディタ・サンプル
- `008/` - PDF 中の要素検出
- `009/` - タブオーダーチェック
- `010/` - ブラウザタイムゾーンチェック

各ディレクトリは「1 ページ完結」の構造です。

## 開発・動作確認

### Dev Container（推奨）

`.devcontainer/docker-compose.yml` を使って Nginx コンテナを立ち上げます。リポジトリ全体が `/usr/share/nginx/html` にボリュームマウントされるため、HTML を編集するとブラウザをリロードするだけで即座に反映されます。

```bash
docker-compose -f .devcontainer/docker-compose.yml up
```

アクセス URL: http://localhost:8083

### ルートの docker-compose で起動

本番を想定した Nginx コンテナ構成です。`Dockerfile` からビルドしたイメージを起動し、ポート 3000 で公開します。

```bash
docker-compose up
```

アクセス URL: http://localhost:3000

### 直接ファイルを開く

ブラウザで `index.html` を直接開いて確認することもできます（一部の動作は HTTP 経由でのアクセスを前提としている場合があります）。

## Nginx / Docker 構成

- **`Dockerfile`**: `nginx:alpine` ベース。`index.html` と各番号付きディレクトリを `/usr/share/nginx/html/` にコピーして配信。
- **`docker-compose.yml`（ルート）**: Dockerfile をビルドし、ポート `3000:80` で公開。
- **`.devcontainer/docker-compose.yml`**: 開発用。ホスト側のリポジトリをボリュームマウントし、ポート `8083:80` で公開。

## 新規テストページ追加時のチェックリスト（重要）

新しい番号付きディレクトリを作成した場合、**以下の 3 ファイルすべてを更新する必要があります**。いずれかの更新を忘れると、本番デプロイ時に 404 エラーやデプロイ未実行が発生します。

1. **`Dockerfile`** に `COPY` 行を追加する
   - 例: `COPY 011/ /usr/share/nginx/html/011/`
   - **これを忘れると、ルートの docker-compose や本番環境で 404 エラーになります**（Dev Container ではボリュームマウントのため問題が発覚しません）

2. **`.github/workflows/deploy-mabl-test.yml`** の `paths` にディレクトリを追加する
   - 例: `- '011/**'`
   - これを忘れると、新規ディレクトリの変更時にデプロイが自動実行されません

3. **`index.html`** のメニューにリンクを追加する
   - 例: `<li><a href="011/">011 - ページタイトル</a></li>`

## 変更時の注意事項

- 各ディレクトリは「テストシナリオごとに完結」しているため、既存のシナリオを壊さないようにしてください
- Dev Container 構成ではリポジトリ全体がそのまま Nginx から配信されるため、`Dockerfile` を更新しなくてもローカルでの動作確認は可能ですが、**本番デプロイには `Dockerfile` の更新が必須**です
